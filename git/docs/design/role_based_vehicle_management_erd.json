{
  "name": "role_based_vehicle_management_erd",
  "format": "dbml",
  "content": "// Users & Roles\nTable users {\n  id uuid [pk]\n  email varchar(255) [not null, unique]\n  password varchar(255) [not null]\n  name varchar(100)\n  phone varchar(20)\n  created_at timestamp\n  updated_at timestamp\n}\n\nTable roles {\n  id int [pk]\n  name varchar(50) [not null, unique] // user, enterprise_admin, technician \ub4f1\n  description text\n}\n\nTable user_roles {\n  id uuid [pk]\n  user_id uuid [ref: > users.id]\n  role_id int [ref: > roles.id]\n  assigned_at timestamp\n}\n\n// Vehicles & Docs\nTable vehicles {\n  id uuid [pk]\n  user_id uuid [ref: > users.id]\n  vin varchar(50)\n  plate_number varchar(20)\n  car_type varchar(20) // ENUM\uc73c\ub85c \ucc98\ub9ac\n  car_model varchar(100)\n  registered_at date\n  is_corporate boolean\n}\n\nTable vehicle_documents {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  original_image_url text\n  ocr_plate_number varchar(20)\n  ocr_vin varchar(50)\n  ocr_model_name varchar(100)\n  ocr_engine_type varchar(50)\n  created_at timestamp\n}\n\n// Repairs\nTable repairs {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  requested_by uuid [ref: > users.id]\n  requested_at timestamp\n  location varchar(200)\n  status varchar(30) // requested, in_progress, completed\n  total_cost int\n}\n\nTable repair_photos {\n  id uuid [pk]\n  repair_id uuid [ref: > repairs.id]\n  image_url text\n  uploaded_at timestamp\n}\n\nTable repair_status_logs {\n  id uuid [pk]\n  repair_id uuid [ref: > repairs.id]\n  status varchar(30)\n  changed_by uuid [ref: > users.id]\n  changed_at timestamp\n}\n\n// Inspections\nTable inspections {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  type varchar(30) // \uc815\uae30\uac80\uc0ac, \uc885\ud569\uac80\uc0ac, \ud29c\ub2dd\uac80\uc0ac, \uc815\ubc00\uac80\uc0ac\n  inspection_date date\n  location varchar(200)\n  result varchar(20) // \ud569\uaca9, \ubd88\ud569\uaca9, \ubbf8\uc2e4\uc2dc\n  cost int\n  created_at timestamp\n}\n\n// Fuel Logs\nTable fuel_logs {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  date date\n  amount int\n  price int\n  station_name varchar(100)\n  created_at timestamp\n}\n\n// Wash Logs\nTable wash_logs {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  date date\n  type varchar(30)\n  price int\n  location varchar(100)\n  created_at timestamp\n}\n\n// Insurances\nTable insurance_providers {\n  id int [pk]\n  name varchar(100) [not null]\n  code varchar(20) [not null]\n  is_active boolean\n}\n\nTable insurances {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  provider_id int [ref: > insurance_providers.id]\n  policy_number varchar(100)\n  coverage_start date\n  coverage_end date\n  status varchar(20) // active, expired, canceled\n  created_at timestamp\n}\n\n// Payments\nTable payments {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  type varchar(20) // repair, inspection, wash\n  amount int\n  method varchar(30) // card, bank, coupon\n  paid_at timestamp\n  created_by uuid [ref: > users.id]\n}\n\n// Enterprise\nTable enterprises {\n  id uuid [pk]\n  name varchar(100)\n  business_number varchar(50) [unique]\n  created_at timestamp\n}\n\nTable enterprise_users {\n  id uuid [pk]\n  enterprise_id uuid [ref: > enterprises.id]\n  user_id uuid [ref: > users.id]\n  role varchar(30) // admin, staff, service\n  is_active boolean\n}\n\n// Delivery\nTable delivery_requests {\n  id uuid [pk]\n  vehicle_id uuid [ref: > vehicles.id]\n  requested_by uuid [ref: > users.id]\n  pickup_location varchar(200)\n  dropoff_location varchar(200)\n  scheduled_at timestamp\n  status varchar(20) // waiting, in_transit, completed\n  created_at timestamp\n}\n\n// Notifications\nTable notifications {\n  id uuid [pk]\n  user_id uuid [ref: > users.id]\n  type varchar(30) // system, alert, warning\n  message text\n  sent_at timestamp\n  read boolean\n}"
}